<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>بيع قطع البيسي</title>
<style>
  body {font-family: Arial, sans-serif; margin:0; padding:0; background:#f0f2f5;}
  header {background:#1a73e8; color:#fff; padding:15px 20px; display:flex; justify-content:space-between; align-items:center; box-shadow:0 2px 5px rgba(0,0,0,0.1);}
  header h1 {margin:0; font-size:24px;}
  .container {display:flex; min-height:calc(100vh - 60px);}
  nav {width:220px; background:#0f2027; color:#fff; min-height:100vh; padding-top:20px; box-shadow:2px 0 5px rgba(0,0,0,0.1);}
  nav a {display:block; color:#fff; padding:12px 20px; text-decoration:none; font-weight:bold;}
  nav a:hover {background:#162b3a; transition:0.3s;}
  main {flex:1; padding:25px;}
  .product {background:#fff; padding:15px 20px; margin-bottom:15px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1);}
  .product h3 {margin-top:0; font-size:20px; color:#1a73e8;}
  .filter {margin-bottom:25px; display:flex; gap:15px; flex-wrap:wrap;}
  input, select, button {padding:10px; border-radius:5px; border:1px solid #ccc; font-size:16px;}
  button {background:#1a73e8; color:#fff; border:none; cursor:pointer; transition:0.3s;}
  button:hover {background:#155ab6;}
  .form-container {background:#fff; padding:25px; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.1); max-width:500px; margin:auto;}
  .form-container h2 {margin-top:0; color:#1a73e8;}
</style>
</head>
<body>

<header>
  <h1>بيع قطع البيسي</h1>
</header>

<div class="container">
  <nav>
    <a href="#" onclick="showHome()">الصفحة الرئيسية</a>
    <a href="#" onclick="showPublish()">نشر منتج</a>
  </nav>
  
  <main id="content">
    <!-- المحتوى يتغير هنا -->
  </main>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyAl3XunFOwHpGw-4_VYyETMtoLgk4mnRpQ",
    authDomain: "a3len-3ad54.firebaseapp.com",
    databaseURL: "https://a3len-3ad54-default-rtdb.firebaseio.com",
    projectId: "a3len-3ad54",
    storageBucket: "a3len-3ad54.firebasestorage.app",
    messagingSenderId: "767338034080",
    appId: "1:767338034080:web:801d77fb74c0aa56e92ac5"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // تسجيل دخول أنونيموس
  firebase.auth().signInAnonymously().catch((error) => { console.error(error); });

  // --- الصفحة الرئيسية ---
  function showHome() {
    document.getElementById('content').innerHTML = `
      <div class="filter">
        <input type="text" id="search" placeholder="ابحث عن منتج" onkeyup="loadProducts()">
        <select id="categoryFilter" onchange="loadProducts()">
          <option value="">كل الأقسام</option>
          <option value="CPU">CPU</option>
          <option value="GPU">GPU</option>
          <option value="RAM">RAM</option>
          <option value="Motherboard">Motherboard</option>
          <option value="Storage">Storage</option>
        </select>
      </div>
      <div id="products"></div>
    `;
    loadProducts();
  }

  function loadProducts() {
    const search = document.getElementById('search')?.value.toLowerCase() || '';
    const category = document.getElementById('categoryFilter')?.value || '';
    db.ref('products').once('value', snapshot => {
      const data = snapshot.val() || {};
      let html = '';
      Object.keys(data).forEach(key => {
        const p = data[key];
        if ((category === '' || p.category === category) &&
            (search === '' || p.name.toLowerCase().includes(search))) {
          html += `<div class="product">
                    <h3>${p.name}</h3>
                    <p>القسم: ${p.category}</p>
                    <p>السعر: ${p.price} د.ع</p>
                  </div>`;
        }
      });
      document.getElementById('products').innerHTML = html || '<p>لا توجد منتجات</p>';
    });
  }

  // --- صفحة نشر المنتج ---
  function showPublish() {
    document.getElementById('content').innerHTML = `
      <div class="form-container">
        <h2>نشر منتج جديد</h2>
        <label>اسم المنتج</label>
        <input type="text" id="prodName" placeholder="اكتب اسم المنتج">
        <label>السعر (د.ع)</label>
        <input type="number" id="prodPrice" placeholder="مثال: 100000">
        <label>القسم</label>
        <select id="prodCategory">
          <option value="CPU">CPU</option>
          <option value="GPU">GPU</option>
          <option value="RAM">RAM</option>
          <option value="Motherboard">Motherboard</option>
          <option value="Storage">Storage</option>
        </select>
        <button onclick="publishProduct()">نشر المنتج</button>
      </div>
    `;
  }

  function publishProduct() {
    const name = document.getElementById('prodName').value.trim();
    const price = document.getElementById('prodPrice').value.trim();
    const category = document.getElementById('prodCategory').value;
    if(!name || !price) { alert('يرجى إكمال جميع الحقول'); return; }

    const newProdRef = db.ref('products').push();
    newProdRef.set({ name, price, category })
      .then(() => { alert('تم نشر المنتج بنجاح'); showHome(); })
      .catch(err => { console.error(err); alert('حدث خطأ أثناء النشر'); });
  }

  // عرض الصفحة الرئيسية أولاً
  showHome();
</script>

</body>
</html>
