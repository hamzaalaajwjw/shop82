# تفعيل إعادة التوجيه
RewriteEngine On

# قاعدة: تحويل a3len.store/profile/username إلى profile.html?id=userId
# نستخدم قاعدة بحث في قاعدة البيانات لتحديد userId من username

# أولاً: استدعاء ملف PHP إذا كان موجوداً للبحث في قاعدة البيانات
# إذا كان لديك PHP، يمكنك إنشاء ملف profile-redirect.php

# إذا لم يكن لديك PHP، يمكنك استخدام JavaScript لإعادة التوجيه
# سنستخدم صفحة وسيطة (profile-redirect.html)

# تحويل a3len.store/profile/username إلى profile-redirect.html?username=username
RewriteRule ^profile/([a-zA-Z0-9_]+)$ profile-redirect.html?username=$1 [L,QSA]

# تحويل a3len.store/profile/username/ إلى profile-redirect.html?username=username
RewriteRule ^profile/([a-zA-Z0-9_]+)/$ profile-redirect.html?username=$1 [L,QSA]

# السماح بالوصول إلى الملفات الثابتة
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# إعادة توجيه كل شيء آخر إلى index.html
RewriteRule ^(.*)$ index.html [L]

# تعيين النوع MIME
AddType text/html .html
AddType text/css .css
AddType application/javascript .js
AddType application/json .json

# تعطيل فهرسة الدليل
Options -Indexes

# الأمان
<FilesMatch "\.(htaccess|htpasswd|ini|log|sh|inc|bak|cfg)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# ضغط الملفات
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/css application/javascript application/json
</IfModule>

# التخزين المؤقت
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType text/html "access plus 1 hour"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType application/json "access plus 1 hour"
</IfModule>
